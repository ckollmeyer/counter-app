<!DOCTYPE html>
<html>
<head>
  <title>Ice Dream Weights</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Arial', sans-serif;
      text-align: center;
      background-color: #f0f4f8;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h1 {
      font-size: 50px;
      color: #1a73e8;
      margin-bottom: 10px;
    }

    h2 {
      font-size: 30px;
      color: #333;
      margin: 20px 0 15px 0;
    }

    .button-row {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 35px;
      width: 100%;
      max-width: 550px;
    }

    .btn {
      font-size: 24px;
      padding: 30px 20px;
      flex: 1;
      min-width: 160px;
      max-width: 220px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      color: white;
      white-space: nowrap;
      text-align: center;
    }

    .btn:hover {
      transform: scale(1.05);
    }

    .under { background-color: #ff9999; }
    .within { 
      background-color: #99ccff; 
      min-width: 200px;
      max-width: 220px;
    }
    .over { background-color: #99ff99; }

    /* Undo button width = combined width of blue + green buttons */
    #undoBtn {
      font-size: 28px;
      padding: 20px 20px;
      border-radius: 15px;
      background-color: #ff6f61; /* red-ish for undo */
      color: white;
      border: none;
      cursor: pointer;
      width: 440px;
      display: block;
      margin: 0 auto 15px auto;
      text-align: center;
    }

    #uploadBtn {
      font-size: 28px;
      padding: 20px 20px;
      border-radius: 15px;
      background-color: #1a73e8;
      color: white;
      border: none;
      cursor: pointer;
      width: 440px;
      display: block;
      margin: 0 auto 30px auto;
      text-align: center;
    }

    #undoBtn:hover, #uploadBtn:hover {
      transform: scale(1.05);
    }

  </style>
</head>
<body>

<h1>Ice Dream Weights</h1>

<!-- Cup Section -->
<h2>Cup 4.3 oz</h2>
<div class="button-row">
  <button class="btn under" id="cupUnderBtn" onclick="inc('cupUnder')">Under (0)</button>
  <button class="btn within" id="cupWithinBtn" onclick="inc('cupWithin')">Within ±0.5 (0)</button>
  <button class="btn over" id="cupOverBtn" onclick="inc('cupOver')">Over (0)</button>
</div>

<!-- Cone Section -->
<h2>Cone 4.5 oz</h2>
<div class="button-row">
  <button class="btn under" id="coneUnderBtn" onclick="inc('coneUnder')">Under (0)</button>
  <button class="btn within" id="coneWithinBtn" onclick="inc('coneWithin')">Within ±0.5 (0)</button>
  <button class="btn over" id="coneOverBtn" onclick="inc('coneOver')">Over (0)</button>
</div>

<!-- Undo Button -->
<button id="undoBtn" onclick="undo()">Undo Last</button>

<!-- Upload Button -->
<button id="uploadBtn" onclick="upload()">Upload to Google Sheets</button>

<script>
  // Counters
  let cupUnder = 0;
  let cupWithin = 0;
  let cupOver = 0;
  let coneUnder = 0;
  let coneWithin = 0;
  let coneOver = 0;

  // Keep track of last increment for undo
  let lastAction = null;

  function inc(which) {
    lastAction = which; // store last increment
    switch(which) {
      case 'cupUnder': cupUnder++; updateButton('cupUnder'); break;
      case 'cupWithin': cupWithin++; updateButton('cupWithin'); break;
      case 'cupOver': cupOver++; updateButton('cupOver'); break;
      case 'coneUnder': coneUnder++; updateButton('coneUnder'); break;
      case 'coneWithin': coneWithin++; updateButton('coneWithin'); break;
      case 'coneOver': coneOver++; updateButton('coneOver'); break;
    }
  }

  function updateButton(which) {
    switch(which) {
      case 'cupUnder':
        document.getElementById('cupUnderBtn').innerText = `Under (${cupUnder})`; break;
      case 'cupWithin':
        document.getElementById('cupWithinBtn').innerText = `Within ±0.5 (${cupWithin})`; break;
      case 'cupOver':
        document.getElementById('cupOverBtn').innerText = `Over (${cupOver})`; break;
      case 'coneUnder':
        document.getElementById('coneUnderBtn').innerText = `Under (${coneUnder})`; break;
      case 'coneWithin':
        document.getElementById('coneWithinBtn').innerText = `Within ±0.5 (${coneWithin})`; break;
      case 'coneOver':
        document.getElementById('coneOverBtn').innerText = `Over (${coneOver})`; break;
    }
  }

  function undo() {
    if (!lastAction) return; // nothing to undo
    switch(lastAction) {
      case 'cupUnder': if(cupUnder>0) cupUnder--; updateButton('cupUnder'); break;
      case 'cupWithin': if(cupWithin>0) cupWithin--; updateButton('cupWithin'); break;
      case 'cupOver': if(cupOver>0) cupOver--; updateButton('cupOver'); break;
      case 'coneUnder': if(coneUnder>0) coneUnder--; updateButton('coneUnder'); break;
      case 'coneWithin': if(coneWithin>0) coneWithin--; updateButton('coneWithin'); break;
      case 'coneOver': if(coneOver>0) coneOver--; updateButton('coneOver'); break;
    }
    lastAction = null; // reset after undo
  }

  function upload() {
    fetch("https://script.google.com/macros/s/AKfycby4c2RGAQeJgMnvEDW2PXgTC_gBgp8gVpA-hVYzhM83POruWTDhGoOU_ZgQCNtw-qVXHg/exec", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        cupUnder, cupWithin, cupOver,
        coneUnder, coneWithin, coneOver
      })
    })
    .then(() => {
      alert("Uploaded to Google Sheets!");
      resetCounters();
    })
    .catch(err => alert("Upload failed: " + err));
  }

  function resetCounters() {
    cupUnder = 0; cupWithin = 0; cupOver = 0;
    coneUnder = 0; coneWithin = 0; coneOver = 0;
    lastAction = null;

    updateButton('cupUnder');
    updateButton('cupWithin');
    updateButton('cupOver');
    updateButton('coneUnder');
    updateButton('coneWithin');
    updateButton('coneOver');
  }
</script>

</body>
</html>
